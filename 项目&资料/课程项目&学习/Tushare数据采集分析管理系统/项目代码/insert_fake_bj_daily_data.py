import sqlite3

# 假数据配置
fake_data = [
    # ts_code, trade_date, open, high, low, close, pre_close, change, pct_chg, vol, amount
    ('830946.BJ', '20240610', 10.1, 10.5, 10.0, 10.3, 10.0, 0.3, 3.0, 10000, 103000),
    ('830946.BJ', '20240611', 10.3, 10.6, 10.2, 10.5, 10.3, 0.2, 1.94, 12000, 126000),
    ('830946.BJ', '20240612', 10.5, 10.7, 10.4, 10.6, 10.5, 0.1, 0.95, 9000, 95400),
    ('830946.BJ', '20240613', 10.6, 10.8, 10.5, 10.7, 10.6, 0.1, 0.94, 11000, 117700),
    ('830946.BJ', '20240614', 10.7, 10.9, 10.6, 10.8, 10.7, 0.1, 0.93, 13000, 140400),

    ('831961.BJ', '20240610', 20.1, 20.5, 20.0, 20.3, 20.0, 0.3, 1.5, 8000, 162400),
    ('831961.BJ', '20240611', 20.3, 20.6, 20.2, 20.5, 20.3, 0.2, 0.98, 9000, 184500),
    ('831961.BJ', '20240612', 20.5, 20.7, 20.4, 20.6, 20.5, 0.1, 0.49, 9500, 195700),
    ('831961.BJ', '20240613', 20.6, 20.8, 20.5, 20.7, 20.6, 0.1, 0.48, 10000, 207000),
    ('831961.BJ', '20240614', 20.7, 20.9, 20.6, 20.8, 20.7, 0.1, 0.48, 11000, 228800),

    ('832089.BJ', '20240610', 30.1, 30.5, 30.0, 30.3, 30.0, 0.3, 1.0, 7000, 212100),
    ('832089.BJ', '20240611', 30.3, 30.6, 30.2, 30.5, 30.3, 0.2, 0.66, 8000, 244000),
    ('832089.BJ', '20240612', 30.5, 30.7, 30.4, 30.6, 30.5, 0.1, 0.33, 8500, 260100),
    ('832089.BJ', '20240613', 30.6, 30.8, 30.5, 30.7, 30.6, 0.1, 0.33, 9000, 276300),
    ('832089.BJ', '20240614', 30.7, 30.9, 30.6, 30.8, 30.7, 0.1, 0.33, 9500, 292600),

    ('833230.BJ', '20240610', 40.1, 40.5, 40.0, 40.3, 40.0, 0.3, 0.75, 6000, 241800),
    ('833230.BJ', '20240611', 40.3, 40.6, 40.2, 40.5, 40.3, 0.2, 0.5, 7000, 283500),
    ('833230.BJ', '20240612', 40.5, 40.7, 40.4, 40.6, 40.5, 0.1, 0.25, 7500, 304500),
    ('833230.BJ', '20240613', 40.6, 40.8, 40.5, 40.7, 40.6, 0.1, 0.25, 8000, 325600),
    ('833230.BJ', '20240614', 40.7, 40.9, 40.6, 40.8, 40.7, 0.1, 0.25, 8500, 346800),

    ('834014.BJ', '20240610', 50.1, 50.5, 50.0, 50.3, 50.0, 0.3, 0.6, 5000, 251500),
    ('834014.BJ', '20240611', 50.3, 50.6, 50.2, 50.5, 50.3, 0.2, 0.4, 6000, 303000),
    ('834014.BJ', '20240612', 50.5, 50.7, 50.4, 50.6, 50.5, 0.1, 0.2, 6500, 328900),
    ('834014.BJ', '20240613', 50.6, 50.8, 50.5, 50.7, 50.6, 0.1, 0.2, 7000, 354900),
    ('834014.BJ', '20240614', 50.7, 50.9, 50.6, 50.8, 50.7, 0.1, 0.2, 7500, 380600),
]

def insert_fake_daily_data():
    conn = sqlite3.connect('stock_data.db')
    cursor = conn.cursor()
    # 修正字段名，兼容你的 daily_data 表结构
    cursor.execute('PRAGMA table_info(daily_data)')
    columns = [col[1] for col in cursor.fetchall()]
    # 兼容 open/open_price, close/close_price 等字段
    if 'open' not in columns and 'open_price' in columns:
        # 字段名映射
        insert_sql = '''
            INSERT OR REPLACE INTO daily_data
            (ts_code, trade_date, open_price, high_price, low_price, close_price, pre_close_price, change, pct_chg, vol, amount)
            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
        '''
    else:
        insert_sql = '''
            INSERT OR REPLACE INTO daily_data
            (ts_code, trade_date, open, high, low, close, pre_close, change, pct_chg, vol, amount)
            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
        '''
    cursor.executemany(insert_sql, fake_data)
    conn.commit()
    conn.close()
    print("已插入北交所(BJ)股票5天假数据。")

if __name__ == '__main__':
    insert_fake_daily_data()
